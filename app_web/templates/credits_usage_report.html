{% load static %}
<div class="container-center">
    <div class="col-12">
        <div class="card mb-4">
            <div class="card-title-table">
                <h4 class="card-header">Credits Usage</h4>
            </div>
            <div>
                <div class="table-responsive text-nowrap table-cls mb-2">
                    <div id="export-buttons-container"></div>
                    <table class="table table-bordered table-hover table-striped" id="credits_usage_table"
                        style="border-top: 1px solid #b8bfc6;    border-bottom: 1px solid #b8bfc6;">
                        <thead>
                            <tr>
                                <th>Datetime</th>
                                <th>Description</th>
                                <th class="text-end">Credited</th>
                                <th class="text-end">Usage</th>
                                <th class="text-end">Balance</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for usage in credits_usage %}
                            <tr>
                                <td class="datetime">{{ usage.transdatetime }}</td>
                                <td style="white-space: pre-line;">{{ usage.description }}</td>
                                <td class="text-end">{{ usage.credit }}</td>
                                <td class="text-end">{{ usage.debit }}</td>
                                <td class="text-end">{{ usage.balance }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .dt-buttons button {
        padding: 5px 15px;
        font-size: 14px;
        border: 1px solid #ccc;
        background-color: #274699;
        border-radius: 4px;
        cursor: pointer;
        color: white;
    }

    .dataTables_filter {
        margin-bottom: 5px !important;
    }
    .dataTables_length{
        margin: 10px !important;
    }

     /* Custom CSS to move the sorting arrows to the left for columns 2, 3, and 4 */
     th:nth-child(3), th:nth-child(4), th:nth-child(5) {
        text-align: left !important;
    }

    th:nth-child(3) .sorting,
    th:nth-child(4) .sorting,
    th:nth-child(5) .sorting {
        float: left;
        margin-left: 10px; /* Adjust spacing as needed */
    }

    th:nth-child(3) .sorting_asc,
    th:nth-child(4) .sorting_asc,
    th:nth-child(5) .sorting_asc {
        margin-left: 10px;
    }

    th:nth-child(3) .sorting_desc,
    th:nth-child(4) .sorting_desc,
    th:nth-child(5) .sorting_desc {
        margin-left: 10px;
    }
    
</style>
<script>
    jQuery(document).ready(function () {
        $.noConflict();

        var table = $('#credits_usage_table').DataTable({
            order: [], // Sort by Datetime column in descending order
            columnDefs: [
                {
                    targets: 0, // Apply to the first column (Datetime)
                    type: 'moment', // Specify that the column type is Moment.js
                    render: function(data, type, row) {
                        // Keep the UI format intact
                        return data; // Just return the data without modification for UI
                    }
                }
            ],
            paging: true,
            pageLength: 10, // Display 10 rows per page by default
            lengthMenu: [10, 25, 50, 100], // Options for the number of records to display
            language: {
                paginate: {
                    previous: '&lt;',
                    next: '&gt;'
                },
                search: "Search:",
                lengthMenu: "Display _MENU_ records per page", // Show the dropdown to select records per page
                zeroRecords: "No records found"
            }
        });

        // Manually add export buttons
        new $.fn.dataTable.Buttons(table, {
            buttons: [
                {
                    extend: 'excelHtml5', // This enables Excel export
                    text: '<i class="fas fa-file-upload"></i>&ensp; Export to Excel',
                    title: 'Credits Usage Report - Hirelines',
                    footer: true, // Enable footer for Excel
                    customize: function (xlsx) {
                    }
                }
            ]
        }).container().appendTo('#export-buttons-container'); // Append buttons to the custom container
    });
</script>